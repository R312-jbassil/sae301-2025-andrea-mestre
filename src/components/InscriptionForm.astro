---
import googleIcon from '../assets/images/google.webp';
---

<div class="w-full max-w-lg mx-auto">
  <!-- Carte d'inscription -->
  <div class="bg-white rounded-2xl shadow-xl p-10 min-h-[650px]">
    <!-- Onglets Connexion / Inscription avec slider -->
    <div class="relative bg-gray-200 rounded-full p-1 mb-8">
      <!-- Slider animé -->
      <div 
        id="slider-inscription"
        class="absolute top-1 bottom-1 right-1 w-[calc(50%-0.25rem)] bg-[#9B8B7E] rounded-full transition-all duration-300 ease-in-out shadow-md"
      ></div>
      
      <!-- Boutons -->
      <div class="relative flex gap-1">
        <button 
          id="connexion-tab-inscription"
          class="flex-1 py-3 rounded-full font-medium transition-colors duration-300 z-10 text-gray-700"
          data-tab="connexion"
        >
          Connexion
        </button>
        <button 
          id="inscription-tab-inscription"
          class="flex-1 py-3 rounded-full font-medium transition-colors duration-300 z-10 text-white"
          data-tab="inscription"
        >
          Inscription
        </button>
      </div>
    </div>

    <!-- Formulaire d'inscription -->
    <form id="inscription-form" class="space-y-6">
      <!-- Nom complet et Email sur la même ligne -->
      <div class="grid grid-cols-2 gap-4">
        <!-- Nom complet -->
        <div>
          <label for="nom" class="block text-sm font-medium text-gray-700 mb-2">
            Nom complet
          </label>
          <div class="relative">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5 absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 pointer-events-none">
              <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 6a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.501 20.118a7.5 7.5 0 0 1 14.998 0A17.933 17.933 0 0 1 12 21.75c-2.676 0-5.216-.584-7.499-1.632Z" />
            </svg>
            <input 
              type="text" 
              id="nom" 
              name="nom"
              placeholder="Votre nom"
              class="w-full pl-12 pr-4 py-3 bg-gray-100 border-0 rounded-lg focus:ring-2 focus:ring-[#92400e] outline-none transition-all"
              required
            />
          </div>
        </div>

        <!-- Email -->
        <div>
          <label for="email-inscription" class="block text-sm font-medium text-gray-700 mb-2">
            Email
          </label>
          <div class="relative">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5 absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 pointer-events-none">
              <path stroke-linecap="round" stroke-linejoin="round" d="M21.75 6.75v10.5a2.25 2.25 0 0 1-2.25 2.25h-15a2.25 2.25 0 0 1-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0 0 19.5 4.5h-15a2.25 2.25 0 0 0-2.25 2.25m19.5 0v.243a2.25 2.25 0 0 1-1.07 1.916l-7.5 4.615a2.25 2.25 0 0 1-2.36 0L3.32 8.91a2.25 2.25 0 0 1-1.07-1.916V6.75" />
            </svg>
            <input 
              type="email" 
              id="email-inscription" 
              name="email"
              placeholder="votre@email.com"
              class="w-full pl-12 pr-4 py-3 bg-gray-100 border-0 rounded-lg focus:ring-2 focus:ring-[#92400e] outline-none transition-all"
              required
            />
          </div>
        </div>
      </div>

      <!-- Mot de passe -->
      <div>
        <label for="password-inscription" class="block text-sm font-medium text-gray-700 mb-2">
          Mot de passe
        </label>
        <div class="relative">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5 absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 pointer-events-none">
            <path stroke-linecap="round" stroke-linejoin="round" d="M16.5 10.5V6.75a4.5 4.5 0 1 0-9 0v3.75m-.75 11.25h10.5a2.25 2.25 0 0 0 2.25-2.25v-6.75a2.25 2.25 0 0 0-2.25-2.25H6.75a2.25 2.25 0 0 0-2.25 2.25v6.75a2.25 2.25 0 0 0 2.25 2.25Z" />
          </svg>
          <input 
            type="password" 
            id="password-inscription" 
            name="password"
            placeholder="••••••••"
            class="w-full pl-12 pr-4 py-3 bg-gray-100 border-0 rounded-lg focus:ring-2 focus:ring-[#92400e] outline-none transition-all"
            required
          />
        </div>
      </div>

      <!-- Confirmer mot de passe -->
      <div>
        <label for="password-confirm" class="block text-sm font-medium text-gray-700 mb-2">
          Confirmer votre mot de passe
        </label>
        <div class="relative">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5 absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 pointer-events-none">
            <path stroke-linecap="round" stroke-linejoin="round" d="M16.5 10.5V6.75a4.5 4.5 0 1 0-9 0v3.75m-.75 11.25h10.5a2.25 2.25 0 0 0 2.25-2.25v-6.75a2.25 2.25 0 0 0-2.25-2.25H6.75a2.25 2.25 0 0 0-2.25 2.25v6.75a2.25 2.25 0 0 0 2.25 2.25Z" />
          </svg>
          <input 
            type="password" 
            id="password-confirm" 
            name="passwordConfirm"
            placeholder="••••••••"
            class="w-full pl-12 pr-4 py-3 bg-gray-100 border-0 rounded-lg focus:ring-2 focus:ring-[#92400e] outline-none transition-all"
            required
          />
        </div>
      </div>

      <!-- Bouton d'inscription -->
      <button 
        type="submit"
        class="w-full bg-gray-900 text-white py-3 rounded-lg font-medium hover:bg-gray-800 transition-colors"
      >
        S'inscrire
      </button>
    </form>

    <!-- Séparateur -->
    <div class="my-8 text-center">
      <span class="text-sm text-gray-500">Ou continuer avec:</span>
    </div>

    <!-- Boutons OAuth -->
    <div class="grid grid-cols-2 gap-4">
      <button 
        class="flex items-center justify-center gap-2 px-4 py-3 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors"
        aria-label="S'inscrire avec Google"
      >
        <img src={googleIcon.src} alt="Google" class="w-5 h-5" />
        <span class="text-sm font-medium text-gray-700">Google</span>
      </button>
      <button 
        class="flex items-center justify-center gap-2 px-4 py-3 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors"
        aria-label="S'inscrire avec Apple"
      >
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 16 16">
          <path d="M11.182.008C11.148-.03 9.923.023 8.857 1.18c-1.066 1.156-.902 2.482-.878 2.516.024.034 1.52.087 2.475-1.258.955-1.345.762-2.391.728-2.43Zm3.314 11.733c-.048-.096-2.325-1.234-2.113-3.422.212-2.189 1.675-2.789 1.698-2.854.023-.065-.597-.79-1.254-1.157a3.692 3.692 0 0 0-1.563-.434c-.108-.003-.483-.095-1.254.116-.508.139-1.653.589-1.968.607-.316.018-1.256-.522-2.267-.665-.647-.125-1.333.131-1.824.328-.49.196-1.422.754-2.074 2.237-.652 1.482-.311 3.83-.067 4.56.244.729.625 1.924 1.273 2.796.576.984 1.34 1.667 1.659 1.899.319.232 1.219.386 1.843.067.502-.308 1.408-.485 1.766-.472.357.013 1.061.154 1.782.539.571.197 1.111.115 1.652-.105.541-.221 1.324-1.059 2.238-2.758.347-.79.505-1.217.473-1.282Z"/>
          <path d="M11.182.008C11.148-.03 9.923.023 8.857 1.18c-1.066 1.156-.902 2.482-.878 2.516.024.034 1.52.087 2.475-1.258.955-1.345.762-2.391.728-2.43Z"/>
        </svg>
        <span class="text-sm font-medium text-gray-700">Apple</span>
      </button>
    </div>
  </div>
</div>

<script>
  // Gestion des onglets avec animation slider
  const connexionTab = document.getElementById('connexion-tab-inscription');
  const inscriptionTab = document.getElementById('inscription-tab-inscription');
  const slider = document.getElementById('slider-inscription');
  
  connexionTab?.addEventListener('click', () => {
    // Émettre un événement personnalisé pour changer de vue
    window.dispatchEvent(new CustomEvent('changeAuthView', { detail: 'connexion' }));
  });
  
  inscriptionTab?.addEventListener('click', () => {
    // Déjà sur l'inscription, ne rien faire
  });

  // Gestion de la soumission du formulaire
  const form = document.getElementById('inscription-form') as HTMLFormElement;
  
  form?.addEventListener('submit', async (e) => {
    e.preventDefault();
    
    const formData = new FormData(form);
    const nom = formData.get('nom');
    const email = formData.get('email');
    const password = formData.get('password');
    const passwordConfirm = formData.get('passwordConfirm');
    
    // Vérifier que les mots de passe correspondent
    if (password !== passwordConfirm) {
      alert('Les mots de passe ne correspondent pas');
      return;
    }
    
    console.log('Tentative d\'inscription:', { nom, email });
    
    // TODO: Implémenter la logique d'inscription avec PocketBase
    // Exemple:
    // try {
    //   const record = await pb.collection('users').create({
    //     name: nom,
    //     email: email,
    //     password: password,
    //     passwordConfirm: passwordConfirm
    //   });
    //   // Connexion automatique après inscription
    //   const authData = await pb.collection('users').authWithPassword(
    //     email as string,
    //     password as string
    //   );
    //   window.location.href = '/';
    // } catch (error) {
    //   console.error('Erreur d\'inscription:', error);
    // }
  });
</script>
